<HTML>
  <HEAD>
    <TITLE>threadpool Documentation</TITLE>
    <LINK HREF="threadpool.css" REL="stylesheet" TYPE="text/css">
  </HEAD>
  <BODY BGCOLOR="#FFFFFF">
    <DIV CLASS="qindex">
      <TABLE BORDER="0" WIDTH="100%">
        <TR>
          <TD ALIGN="LEFT">
            <B>threadpool</B>
          </TD>
          <TD ALIGN="RIGHT">
            <A CLASS="qindex" HREF="../index.html">Overview</A> |
            <A CLASS="qindex" HREF="../reference/annotated.html">Reference</A> |
            <A CLASS="qindex" HREF="../tutorial/intro.html">Tutorial</A> |
            <A CLASS="qindex" HREF="../examples/intro.html">Examples</A> |
            <A CLASS="qindex" HREF="../design/intro.html">Design</A>
          </TD>
        </TR>
      </TABLE>
    </DIV>
    <DIV CLASS="qindex">
      <TABLE BORDER="0" WIDTH="100%">
        <TR>
          <TD ALIGN="LEFT">
            <B>Reference</B>
          </TD>
          <TD ALIGN="RIGHT">
            <A CLASS="qindex" HREF="annotated.html">Class List</A> |
            <A CLASS="qindex" HREF="functions.html">Member Functions</A> |
            <A CLASS="qindex" HREF="namespacemembers.html">Typedefs</A> |
            <A CLASS="qindex" HREF="files.html">File List</A>
          </TD>
        </TR>
      </TABLE>
    </DIV>
<!-- Generated by Doxygen 1.8.9.1 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e6bb53534ac0e427887cf7a94c0c004e.html">C:</a></li><li class="navelem"><a class="el" href="dir_8ceffd4ee35c3518d4e8bdc7e638efe8.html">Users</a></li><li class="navelem"><a class="el" href="dir_39b78db740f68382f8b98ac809268452.html">dekhtiar</a></li><li class="navelem"><a class="el" href="dir_c638e63b661dc03218f23f4bdb932d82.html">Downloads</a></li><li class="navelem"><a class="el" href="dir_92e0801082930394843c8db43554a6b2.html">threadpool-0_2_5-src</a></li><li class="navelem"><a class="el" href="dir_8665da6c1bc7f5aff6e731e870da715b.html">threadpool-0_2_5-src</a></li><li class="navelem"><a class="el" href="dir_5fe689c47ef33b814a84e41b25604e45.html">threadpool</a></li><li class="navelem"><a class="el" href="dir_00eb2e479faf7753dc74166eaa155c66.html">boost</a></li><li class="navelem"><a class="el" href="dir_97a6bb3187400573de8caf134b34958b.html">threadpool</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">task_adaptors.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a00021.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#ifndef THREADPOOL_TASK_ADAPTERS_HPP_INCLUDED</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#define THREADPOOL_TASK_ADAPTERS_HPP_INCLUDED</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;boost/smart_ptr.hpp&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;boost/function.hpp&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;boost/thread.hpp&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">namespace </span><a class="code" href="a00022.html">boost</a> { <span class="keyword">namespace </span>threadpool</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="a00023.html#ac6f15485d0c9225572afc57b30f50358">   37</a></span>&#160;  <span class="keyword">typedef</span> function0&lt;void&gt; <a class="code" href="a00023.html#ac6f15485d0c9225572afc57b30f50358">task_func</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="a00008.html">   51</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a00008.html">prio_task_func</a></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_priority;  </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    task_func m_function;     </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="a00008.html#aa7977071f7d2aed3b105ef9681553578">   58</a></span>&#160;    <span class="keyword">typedef</span> <span class="keywordtype">void</span> <a class="code" href="a00008.html#aa7977071f7d2aed3b105ef9681553578">result_type</a>; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="a00008.html#a4223c1c97c5e6fb942f7058f0e80ceba">   65</a></span>&#160;    <a class="code" href="a00008.html#a4223c1c97c5e6fb942f7058f0e80ceba">prio_task_func</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> priority, task_func <span class="keyword">const</span> &amp; <span class="keyword">function</span>)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      : m_priority(priority)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      , m_function(function)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="a00008.html#a79168ecc681deee0ed004d10176c8bfe">   73</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a00008.html#a79168ecc681deee0ed004d10176c8bfe">operator() </a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">if</span>(m_function)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        m_function();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="a00008.html#a1c28c491e589e6b3de2b21e66a1f8544">   85</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="a00008.html#a1c28c491e589e6b3de2b21e66a1f8544">operator&lt; </a>(<span class="keyword">const</span> <a class="code" href="a00008.html">prio_task_func</a>&amp; rhs)<span class="keyword"> const</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">return</span> m_priority &lt; rhs.m_priority; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  };  <span class="comment">// prio_task_func</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="a00006.html">  107</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a00006.html">looped_task_func</a></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    function0&lt;bool&gt; m_function;   </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_break_s;              </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_break_ns;             </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="a00006.html#a0de81e4d23aed52a73fe5ee2d11deaf6">  115</a></span>&#160;    <span class="keyword">typedef</span> <span class="keywordtype">void</span> <a class="code" href="a00006.html#a0de81e4d23aed52a73fe5ee2d11deaf6">result_type</a>; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="a00006.html#a46f85a3e3bbde3eaf0e2a186dfbd6e16">  122</a></span>&#160;    <a class="code" href="a00006.html#a46f85a3e3bbde3eaf0e2a186dfbd6e16">looped_task_func</a>(function0&lt;bool&gt; <span class="keyword">const</span> &amp; <span class="keyword">function</span>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> interval = 0)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      : m_function(function)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      m_break_s  = interval / 1000;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      m_break_ns = (interval - m_break_s * 1000) * 1000 * 1000;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="a00006.html#aab9445cd9c082d77c56eee21175f3133">  131</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a00006.html#aab9445cd9c082d77c56eee21175f3133">operator() </a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">if</span>(m_function)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span>(m_break_s &gt; 0 || m_break_ns &gt; 0)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        { <span class="comment">// Sleep some time before first execution</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          xtime xt;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          xtime_get(&amp;xt, TIME_UTC);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          xt.nsec += m_break_ns;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          xt.sec += m_break_s;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          thread::sleep(xt); </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">while</span>(m_function())</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="keywordflow">if</span>(m_break_s &gt; 0 || m_break_ns &gt; 0)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            xtime xt;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            xtime_get(&amp;xt, TIME_UTC);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            xt.nsec += m_break_ns;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            xt.sec += m_break_s;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            thread::sleep(xt); </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            thread::yield(); <span class="comment">// Be fair to other threads</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  }; <span class="comment">// looped_task_func</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;} } <span class="comment">// namespace boost::threadpool</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">#endif // THREADPOOL_TASK_ADAPTERS_HPP_INCLUDED</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="ttc" id="a00022_html"><div class="ttname"><a href="a00022.html">boost</a></div><div class="ttdoc">The namespace threadpool contains a thread pool and related utility classes. </div><div class="ttdef"><b>Definition:</b> <a href="a00015_source.html#l00030">future.hpp:30</a></div></div>
<div class="ttc" id="a00006_html_aab9445cd9c082d77c56eee21175f3133"><div class="ttname"><a href="a00006.html#aab9445cd9c082d77c56eee21175f3133">boost::threadpool::looped_task_func::operator()</a></div><div class="ttdeci">void operator()(void) const </div><div class="ttdef"><b>Definition:</b> <a href="a00021_source.html#l00131">task_adaptors.hpp:131</a></div></div>
<div class="ttc" id="a00006_html_a46f85a3e3bbde3eaf0e2a186dfbd6e16"><div class="ttname"><a href="a00006.html#a46f85a3e3bbde3eaf0e2a186dfbd6e16">boost::threadpool::looped_task_func::looped_task_func</a></div><div class="ttdeci">looped_task_func(function0&lt; bool &gt; const &amp;function, unsigned int const interval=0)</div><div class="ttdef"><b>Definition:</b> <a href="a00021_source.html#l00122">task_adaptors.hpp:122</a></div></div>
<div class="ttc" id="a00006_html"><div class="ttname"><a href="a00006.html">boost::threadpool::looped_task_func</a></div><div class="ttdoc">Looped task function object. </div><div class="ttdef"><b>Definition:</b> <a href="a00021_source.html#l00107">task_adaptors.hpp:107</a></div></div>
<div class="ttc" id="a00008_html_a1c28c491e589e6b3de2b21e66a1f8544"><div class="ttname"><a href="a00008.html#a1c28c491e589e6b3de2b21e66a1f8544">boost::threadpool::prio_task_func::operator&lt;</a></div><div class="ttdeci">bool operator&lt;(const prio_task_func &amp;rhs) const </div><div class="ttdef"><b>Definition:</b> <a href="a00021_source.html#l00085">task_adaptors.hpp:85</a></div></div>
<div class="ttc" id="a00008_html_a4223c1c97c5e6fb942f7058f0e80ceba"><div class="ttname"><a href="a00008.html#a4223c1c97c5e6fb942f7058f0e80ceba">boost::threadpool::prio_task_func::prio_task_func</a></div><div class="ttdeci">prio_task_func(unsigned int const priority, task_func const &amp;function)</div><div class="ttdef"><b>Definition:</b> <a href="a00021_source.html#l00065">task_adaptors.hpp:65</a></div></div>
<div class="ttc" id="a00008_html_a79168ecc681deee0ed004d10176c8bfe"><div class="ttname"><a href="a00008.html#a79168ecc681deee0ed004d10176c8bfe">boost::threadpool::prio_task_func::operator()</a></div><div class="ttdeci">void operator()(void) const </div><div class="ttdef"><b>Definition:</b> <a href="a00021_source.html#l00073">task_adaptors.hpp:73</a></div></div>
<div class="ttc" id="a00008_html"><div class="ttname"><a href="a00008.html">boost::threadpool::prio_task_func</a></div><div class="ttdoc">Prioritized task function object. </div><div class="ttdef"><b>Definition:</b> <a href="a00021_source.html#l00051">task_adaptors.hpp:51</a></div></div>
<div class="ttc" id="a00023_html_ac6f15485d0c9225572afc57b30f50358"><div class="ttname"><a href="a00023.html#ac6f15485d0c9225572afc57b30f50358">boost::threadpool::task_func</a></div><div class="ttdeci">function0&lt; void &gt; task_func</div><div class="ttdoc">Standard task function object. </div><div class="ttdef"><b>Definition:</b> <a href="a00021_source.html#l00037">task_adaptors.hpp:37</a></div></div>
<div class="ttc" id="a00006_html_a0de81e4d23aed52a73fe5ee2d11deaf6"><div class="ttname"><a href="a00006.html#a0de81e4d23aed52a73fe5ee2d11deaf6">boost::threadpool::looped_task_func::result_type</a></div><div class="ttdeci">void result_type</div><div class="ttdoc">Indicates the functor&#39;s result type. </div><div class="ttdef"><b>Definition:</b> <a href="a00021_source.html#l00115">task_adaptors.hpp:115</a></div></div>
<div class="ttc" id="a00008_html_aa7977071f7d2aed3b105ef9681553578"><div class="ttname"><a href="a00008.html#aa7977071f7d2aed3b105ef9681553578">boost::threadpool::prio_task_func::result_type</a></div><div class="ttdeci">void result_type</div><div class="ttdoc">Indicates the functor&#39;s result type. </div><div class="ttdef"><b>Definition:</b> <a href="a00021_source.html#l00058">task_adaptors.hpp:58</a></div></div>
</div><!-- fragment --></div><!-- contents -->
    <BR>
    <DIV CLASS="qindex">
      <TABLE BORDER="0" WIDTH="100%">
        <TR>
		  <TD CLASS="tiny" ALIGN="LEFT">Copyright &copy 2005-2008 Philipp Henkel</TD>
          <TD ALIGN="RIGHT">
            <A CLASS="qindex" HREF="../index.html">Overview</A> |
            <A CLASS="qindex" HREF="../reference/annotated.html">Reference</A> |
            <A CLASS="qindex" HREF="../tutorial/intro.html">Tutorial</A> |
            <A CLASS="qindex" HREF="../examples/intro.html">Examples</A> |
            <A CLASS="qindex" HREF="../design/intro.html">Design</A>
          </TD>
        </TR>       
      </TABLE>
    </DIV>  
  </BODY>
</HTML>
