<HTML>
  <HEAD>
    <TITLE>threadpool Documentation</TITLE>
    <LINK HREF="threadpool.css" REL="stylesheet" TYPE="text/css">
  </HEAD>
  <BODY BGCOLOR="#FFFFFF">
    <DIV CLASS="qindex">
      <TABLE BORDER="0" WIDTH="100%">
        <TR>
          <TD ALIGN="LEFT">
            <B>threadpool</B>
          </TD>
          <TD ALIGN="RIGHT">
            <A CLASS="qindex" HREF="../index.html">Overview</A> |
            <A CLASS="qindex" HREF="../reference/annotated.html">Reference</A> |
            <A CLASS="qindex" HREF="../tutorial/intro.html">Tutorial</A> |
            <A CLASS="qindex" HREF="../examples/intro.html">Examples</A> |
            <A CLASS="qindex" HREF="../design/intro.html">Design</A>
          </TD>
        </TR>
      </TABLE>
    </DIV>
    <DIV CLASS="qindex">
      <TABLE BORDER="0" WIDTH="100%">
        <TR>
          <TD ALIGN="LEFT">
            <B>Tutorial</B>
          </TD>
          <TD ALIGN="RIGHT">
            <A CLASS="qindex" HREF="intro.html">Quick Start</A> |
            <A CLASS="qindex" HREF="prioritized.html">Prioritized Tasks</A> |
            <A CLASS="qindex" HREF="task_adaptor.html">Arbitrary Task Functions</A> |
            <A CLASS="qindex" HREF="instantiation.html">Advanced Pool Instantiation</A>            
          </TD>
        </TR>
      </TABLE>
    </DIV>
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Prioritized Tasks </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>TODO This tutorial is out dated.</p>
<p>It's easy to prioritize asynchronous tasks by using the task adaptor prio_task_func. The following source listing illustrates how to setup the pool and add the tasks:</p>
<div class="fragment"><div class="line">01 </div>
<div class="line">02  #include <span class="stringliteral">&quot;threadpool.hpp&quot;</span></div>
<div class="line">03</div>
<div class="line">04  <span class="keyword">using namespace </span>boost::threadpool;</div>
<div class="line">05</div>
<div class="line">06  <span class="comment">// Some example tasks</span></div>
<div class="line">07  <span class="keywordtype">void</span> normal_task()</div>
<div class="line">08  {</div>
<div class="line">09    ...</div>
<div class="line">10  }</div>
<div class="line">11</div>
<div class="line">13  <span class="keywordtype">void</span> important_task()</div>
<div class="line">14  {</div>
<div class="line">15    ...</div>
<div class="line">16  }</div>
<div class="line">17  </div>
<div class="line">18  <span class="keywordtype">void</span> execute_prioritized()</div>
<div class="line">19  {</div>
<div class="line">20    <span class="comment">// Create prioritized thread pool container without any threads.</span></div>
<div class="line">21    scoped_pool&lt;prio_pool, 0&gt; tp;</div>
<div class="line">22</div>
<div class="line">23    <span class="comment">// Add some tasks to the pool.</span></div>
<div class="line">24    tp += prio_task_func(5,   &amp;normal_task);</div>
<div class="line">25    tp += prio_task_func(100, &amp;important_task);</div>
<div class="line">26    tp += prio_task_func(7,   &amp;normal_task);</div>
<div class="line">27</div>
<div class="line">28    <span class="comment">// Add the some threads to the pool. This will start the execution of the tasks.</span></div>
<div class="line">29    tp-&gt;resize(2);</div>
<div class="line">30</div>
<div class="line">31    <span class="comment">// The tasks are processed according to their priority: important_task(100), nonrelevant_task(7), nonrelevant_task(5).</span></div>
<div class="line">32</div>
<div class="line">33    tp-&gt;wait();</div>
<div class="line">34    </div>
<div class="line">35    <span class="comment">// Now all tasks are finished and the pool will be destroyed safely when tp goes out of scope.</span></div>
<div class="line">36  }</div>
<div class="line">37</div>
</div><!-- fragment --><p>Like in the first tutorial we start including the main header file and defining some tasks.</p>
<p>At line 21 a prioritized thread pool is created. That means that the pool's tasks are arranged according to their priority before they get executed. Therefore the tasks themselves have to realize a partial ordering based on operator&lt;.</p>
<p>The adaptor prio_thread_func satisfies our requirements regarding the order and is just a small wrapper object for the task functions. In line 24 to 26 some prioritized tasks are scheduled. This time the pool's schedule function is used and like smart pool's += operator this function returns immediately.</p>
<p>At line 29 the first thread is added to the pool and the execution of important_task begins. As we have only one thread the tasks are processed sequentially.</p>
<p>Finally wait() is called to ensure that all tasks are finished before our example function returns and the pool is destroyed. This is very important since the behavior is undefined if pool's lifetime ends while tasks are executed. </p>
</div></div><!-- contents -->
    <BR>
    <DIV CLASS="qindex">
      <TABLE BORDER="0" WIDTH="100%">
        <TR>
		  <TD CLASS="tiny" ALIGN="LEFT">Copyright &copy 2005-2008 Philipp Henkel</TD>
          <TD ALIGN="RIGHT">
            <A CLASS="qindex" HREF="../index.html">Overview</A> |
            <A CLASS="qindex" HREF="../reference/annotated.html">Reference</A> |
            <A CLASS="qindex" HREF="../tutorial/intro.html">Tutorial</A> |
            <A CLASS="qindex" HREF="../examples/intro.html">Examples</A> |
            <A CLASS="qindex" HREF="../design/intro.html">Design</A>
          </TD>
        </TR>       
      </TABLE>
    </DIV>  
  </BODY>
</HTML>
